<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template
        id="portal_my_survey_answers_stages"
        inherit_id="survey_contact_ids.portal_my_survey_answers_contacts"
        name="My Survey Answers"
    >
        <xpath expr="//th[@id='th-contacts']" position="after">
            <th id="th-stage">Stage</th>
        </xpath>
        <xpath expr="//td[@id='td-contacts']" position="after">
            <td id="td-stage">
                <t t-set="answer_state">badge-default</t>
                <t t-if="answer.stage_id.is_editable">
                    <t t-set="answer_state">badge-warning</t>
                </t>
                <t t-if="answer.stage_id.is_accepted">
                    <t t-set="answer_state">badge-success</t>
                </t>
                <t t-if="answer.stage_id.is_cancel">
                    <t t-set="answer_state">badge-danger</t>
                </t>
                <t t-if="answer.stage_id.is_sent">
                    <t t-set="answer_state">badge-info</t>
                </t>
                 <span
                    t-field="answer.stage_id.name"
                    t-attf-class="badge badge-pill {{answer_state}}"
                    data-toggle="tooltip"
                    t-att-title="answer.stage_id.name"
                />
            </td>
        </xpath>
        <xpath expr="//a[@id='button-review-answer']" position="before">
            <t
                t-if="answer.is_editable and answer.survey_id.state not in ['closed', 'draft']"
            >
                <a
                    id="button-edit-answers"
                    t-att-href="'/survey/edit/%s/%s' % (answer.survey_id.access_token, answer.access_token)"
                    class="btn btn-link float-right no-decoration"
                >Edit Answers</a>
            </t>
        </xpath>
    </template>
    <template
        id="portal_answer_page_stage"
        name="Survey Answer Portal Template"
        inherit_id="survey_portal.portal_answer_page"
    >
        <xpath expr="//h2[@id='survey_portal_sidebar_title']" position="after">
            <t t-set="answer_state">badge-default</t>
            <t t-if="answer.stage_id.is_editable">
                <t t-set="answer_state">badge-warning</t>
            </t>
            <t t-if="answer.stage_id.is_accepted">
                <t t-set="answer_state">badge-success</t>
            </t>
            <t t-if="answer.stage_id.is_cancel">
                <t t-set="answer_state">badge-danger</t>
            </t>
            <t t-if="answer.stage_id.is_sent">
                <t t-set="answer_state">badge-info</t>
            </t>
            <div><span
                    t-attf-class="badge badge-pill o_portal_sidebar_stage ml4 {{answer_state}}"
                    t-field="answer.stage_id.name"
                    data-toggle="tooltop"
                    t-att-title="answer.stage_id.name"
                /></div>
        </xpath>
        <xpath
            expr="//ul[@id='survey_portal_sidebar_list']//a[hasclass('o_review_survey_btn')]//.."
            position="after"
        >
            <t
                t-if="answer.is_editable and answer.survey_id.state not in ['closed', 'draft']"
            >
                <div class="btn-group flex-grow-1 mr-1 mb-1">
                    <a
                        class="btn btn-secondary btn-block o_edit_survey_btn"
                        t-att-href="'/survey/edit/%s/%s' % (answer.survey_id.access_token, answer.access_token)"
                        title="Edit"
                    ><i class="fa fa-pencil" /> Edit</a>
                </div>
            </t>
        </xpath>
    </template>
</odoo>
